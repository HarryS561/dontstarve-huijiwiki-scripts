"use strict";(()=>{var V=class{constructor(e){this.client=e}async sendEvent({apiKey:e,events:t,notifier:r,payloadVersion:n}){let o=new Date().toISOString(),a=JSON.stringify({apiKey:e,payloadVersion:n,notifier:r,events:t});await fetch(this.client.endpoints.notify,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json","Bugsnag-Api-Key":e,"Bugsnag-Payload-Version":n,"Bugsnag-Sent-At":o},referrerPolicy:"no-referrer",body:a})}},F=Symbol("Circular"),_=Symbol("AccessError");function K(e,t,r){return w({key:"",value:e,replacer:t,seen:[],depth:0,depthLimit:r?.depthLimit,edgeIndex:0,edgesLimit:r?.edgesLimit})}function w({key:e,value:t,replacer:r,seen:n,depthLimit:o=1/0,depth:a,edgeIndex:i,edgesLimit:c=1/0}){let s=t;if(n.includes(s)&&(s=F),r&&(s=r(e,s)),q(s)&&(s=E(()=>s.toJSON(String(e)))),s===null||typeof s!="object")return s;if(a>o||i+1>c)return"[...]";if(n.push(t),Array.isArray(s)){let l=[],d=Math.min(s.length,c);for(let u=0;u<d;u++){let f=E(()=>s[u]);l.push(w({key:u,value:f,replacer:r,seen:n,depth:a,depthLimit:o,edgeIndex:u,edgesLimit:c}))}d<s.length&&l.push("[...]"),s=l}else{let l={},d=Object.keys(s);for(let u=0;u<d.length;u++){let f=d[u],h=E(()=>s[f]);l[f]=w({key:f,value:h,replacer:r,seen:n,depth:a,depthLimit:o,edgeIndex:u,edgesLimit:c})}s=l}return n.pop(),s}function E(e){try{return e()}catch{return _}}function q(e){return typeof e=="object"&&e!==null&&"toJSON"in e&&typeof e.toJSON=="function"}var H=Object.prototype.toString,J=Object.getPrototypeOf,X="[object Error]";function z(e){if(typeof Error.isError=="function")return Error.isError(e);if(e instanceof Error)return!0;let t=e;for(;t;){if(H.call(t)===X)return!0;t=J(t)}return!1}function S(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}var x=/^\s*at .*(\S+:\d+|\(native\))/m,G=/^(eval@)?(\[native code])?$/;function Y(e){return(e.match(x)?Q(e):Z(e)).reduce((t,r)=>{if(JSON.stringify(r)==="{}")return t;let n=!r.file&&!r.method&&typeof r.lineNumber=="number"?"global code":r.file||"(unknown file)";n=n.replace(/\?.*$/,"").replace(/#.*$/,"");let o=r.method||"(unknown function)";return o=/^global code$/i.test(o)?"global code":o,t.concat([{file:n,lineNumber:r.lineNumber,columnNumber:r.columnNumber,method:o}])},[])}function Q(e){return e.split(`
`).filter(t=>!!t.match(x)).map(t=>{t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let r=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),n=r.match(/ (\((.+):(\d+):(\d+)\)$)/);r=n?r.replace(n[0],""):r;let o=r.split(/\s+/).slice(1),a=N(n?n[1]:o.pop()||"(no location)"),i=o.join(" ")||void 0;return{file:["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0],lineNumber:a[1],columnNumber:a[2],method:i}})}function Z(e){return e.split(`
`).filter(t=>!t.match(G)).map(t=>{if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),t.indexOf("@")===-1&&t.indexOf(":")===-1)return{method:t};{let r=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=t.match(r),o=n&&n[1]?n[1]:void 0,a=N(t.replace(r,""));return{file:a[0],lineNumber:a[1],columnNumber:a[2],method:o}}})}function N(e){if(e.indexOf(":")===-1)return[e];let t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)return[e];let r=t[2]?parseInt(t[2],10):void 0,n=t[3]?parseInt(t[3],10):void 0;return[t[1],r,n]}function g(e,t){let r=B(e,t),n;r.name==="InvalidError"&&(n={[t]:{"non-error parameter":e}}),typeof r.metadata<"u"&&S(r.metadata)&&(n={...n,[r.name]:r.metadata});let o=[v(r)];return o.push(...C(r).map(a=>v(a,{backtrace:!1}))),{exceptions:o,metadata:n}}function B(e,t){if(z(e))return e;let r=ee(e);if(r)return r;switch(typeof r){case"string":case"number":case"boolean":return new Error(String(e));default:return r=new Error(`${t} received a non-error. See "${t}" tab for more detail.`),r.name="InvalidError",r}}function ee(e){if(!S(e))return null;let t=a=>typeof e[a]=="string"&&e[a].length?e[a]:void 0,r=t("name")||t("errorClass"),n=t("message")||t("errorMessage");if(!r)return null;let o=new Error(n);return o.name=r,o}function v(e,t={backtrace:!1}){return{errorClass:e.name,message:e.message,stacktrace:te(e,t),type:typeof self=="object"&&self.navigator?"browserjs":"nodejs"}}function te(e,{backtrace:t}){let r=re(e);return r?Y(r):t?oe():[]}function re(e){let t=e.stack||e.stacktrace;return typeof t=="string"&&t.length&&t!==`${e.name}: ${e.message}`?t:void 0}var ne=20;function oe(){let e=[],t;try{t=arguments.callee}catch{return[]}for(;t&&e.length<ne;){t.name?e.push({method:t.name,file:"(unknown file)"}):/function(?:\s+([\w$]+))+\s*\(/.test(t.toString())&&e.push({method:RegExp.$1,file:"(unknown file)"});try{t=t.caller}catch{break}}return e}function C(e){if(!e.cause)return[];let t=B(e.cause,"cause");return t.name==="InvalidError"?[]:[t].concat(C(t))}var k={name:"browserNotifyUnhandledExceptions",load(e){self.addEventListener("error",t=>{let r,n;if(t instanceof ErrorEvent){let{message:o,filename:a,lineno:i,colno:c,error:s}=t,l=Number.isSafeInteger(i)?i:void 0;if(l===0&&/Script error\.?/.test(o)){console.log("Ignoring cross-domain or eval script error.");return}({exceptions:r,metadata:n}=g(s,"window onerror"));let d=Number.isSafeInteger(c)?c:void 0,{stacktrace:u}=r[0];if(!u.length)u.push({file:a,lineNumber:l,columnNumber:d,method:"(unknown file)"});else{let f=u[0];f.file=f.file||a,f.lineNumber=f.lineNumber??l,f.columnNumber=f.columnNumber??d}}else({exceptions:r,metadata:n}=g(t,"window onerror"));e.notifyEvent({exceptions:r,unhandled:!0,severity:"error",severityReason:{type:"unhandledException"},metadata:n},t)})}},j={name:"browserNotifyUnhandledRejections",load(e){self.addEventListener("unhandledrejection",t=>{let r=t.reason,{exceptions:n,metadata:o}=g(r,"unhandledrejection");e.notifyEvent({exceptions:n,unhandled:!0,severity:"error",severityReason:{type:"unhandledPromiseRejection"},metadata:o},r)})}},R={name:"consoleBreadcrumbs",load(e){let t=["log","debug","info","warn","error"].filter(r=>typeof console<"u"&&typeof console[r]=="function");for(let r of t){let n=console[r];console[r]=(...o)=>{e.leaveBreadcrumb("Console output",o.reduce((a,i,c)=>{let s="[Unknown value]";try{s=String(i)}catch{}if(s==="[object Object]")try{s=JSON.stringify(i)}catch{}return a[`[${c}]`]=s,a},{severity:r}),"log"),n.apply(console,o)}}}},$={name:"errorBreadcrumbs",load(e){e.addOnPostError(t=>{e.leaveBreadcrumb(t.exceptions[0].errorClass,{errorClass:t.exceptions[0].errorClass,errorMessage:t.exceptions[0].message,severity:t.severity},"error")})}},A={name:"fetchBreadcrumbs",load(e){if(!("fetch"in self))return;let t=self.fetch;self.fetch=function(n,o){let a="GET",i;ae(n)?(i=n.url,a=n.method):i=n.toString(),o&&typeof o.method=="string"&&o.method.length&&(a=o.method);let c=e.leaveBreadcrumb.bind(e);return new Promise((s,l)=>{t(n,o).then(d=>{se({response:d,method:a,url:i,leaveBreadcrumb:c}),s(d)}).catch(d=>{ie({method:a,url:i,leaveBreadcrumb:c}),l(d)})})}}};function ae(e){return e instanceof Request||S(e)&&"url"in e}function se({response:e,method:t,url:r,leaveBreadcrumb:n}){if(r.startsWith("https://notify.bugsnag.com"))return;let o={status:e.status,request:`${t} ${r}`};e.status>=400?n("fetch() failed",o,"request"):n("fetch() succeeded",o,"request")}function ie({method:e,url:t,leaveBreadcrumb:r}){t.startsWith("https://notify.bugsnag.com")||r("fetch() error",{request:`${e} ${t}`},"request")}var P={name:"navigationBreadcrumbs",load(e){if(!("addEventListener"in self))return;let t=n=>()=>e.leaveBreadcrumb(n,void 0,"navigation");self.addEventListener("pagehide",t("Page hidden"),!0),self.addEventListener("pageshow",t("Page shown"),!0),self.addEventListener("load",t("Page loaded"),!0),self.document&&self.document.addEventListener("DOMContentLoaded",t("DOMContentLoaded"),!0),self.addEventListener("load",()=>self.addEventListener("popstate",t("Navigated back"),!0)),self.location&&self.addEventListener("hashchange",n=>{let o=n.oldURL?{from:y(n.oldURL),to:y(n.newURL),state:W(self)}:{to:y(self.location.href)};e.leaveBreadcrumb("Hash changed",o,"navigation")},!0);let r=e.leaveBreadcrumb.bind(e);self.history&&self instanceof Window&&(typeof self.history.replaceState=="function"&&O({fn:"replaceState",target:self.history,leaveBreadcrumb:r,win:self}),typeof self.history.pushState=="function"&&O({fn:"pushState",target:self.history,leaveBreadcrumb:r,win:self}))}};function y(e){try{let t=new URL(e);return`${t.pathname}${t.search}${t.hash}`}catch{return e}}function W(e){try{return e.history.state}catch{return{}}}function O({fn:e,leaveBreadcrumb:t,target:r,win:n}){let o=r[e];r[e]=(a,i,c)=>{t(`History ${e}`,ce({win:n,state:a,title:i,url:c}),"navigation"),o.apply(r,[a,i,c])}}function ce({win:e,state:t,title:r,url:n}){let o=y(e.location.href);return{title:r,state:t,prevState:W(e),to:n||o,from:o}}var D=Date.now(),de=()=>{D=Date.now()},T={name:"appDuration",load(e){return e.addOnError(t=>{let r=Date.now();t.app=t.app||{},t.app.duration=r-D}),{reset:de}}};function le(e){let t=fe(e);if(!t)return{};let[r,n]=t,o=he(e),a=o?.osName==="iOS"?pe(e):{};return{browserName:r,browserVersion:n[1],osName:o?.osName,osVersion:o?.osVersion,manufacturer:a?.manufacturer,model:a?.model}}var ue=[["Edge (EdgeHTML)",/Edge\/([0-9._]+)/],["Edge (iOS)",/EdgiOS\/([0-9._]+)/],["Yandex",/YaBrowser\/([0-9._]+)/],["KakaoTalk",/KAKAOTALK\s([0-9.]+)/],["Samsung",/SamsungBrowser\/([0-9.]+)/],["Silk",/\bSilk\/([0-9._-]+)\b/],["MIUI",/MiuiBrowser\/([0-9.]+)$/],["Beaker",/BeakerBrowser\/([0-9.]+)/],["Edge (Chromium)",/EdgA?\/([0-9.]+)/],["Chromium WebView",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/],["Chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/],["Chrome (iOS)",/CriOS\/([0-9.]+)(:?\s|$)/],["Firefox",/Firefox\/([0-9.]+)(?:\s|$)/],["Firefox (iOS)",/FxiOS\/([0-9.]+)/],["Opera Mini",/Opera Mini.*Version\/([0-9.]+)/],["Opera",/Opera\/([0-9.]+)(?:\s|$)/],["Opera",/OPR\/([0-9.]+)(:?\s|$)/],["Internet Explorer",/Trident\/7\.0.*rv:([0-9.]+).*\).*Gecko$/],["Internet Explorer",/MSIE\s([0-9.]+);.*Trident\/[4-7].0/],["Internet Explorer",/MSIE\s(7\.0)/],["Blackberry",/BB10;\sTouch.*Version\/([0-9.]+)/],["Android",/Android\s([0-9.]+)/],["Safari (iOS)",/Version\/([0-9._]+).*Mobile.*Safari.*/],["Safari",/Version\/([0-9._]+).*Safari/],["Facebook",/FB[AS]V\/([0-9.]+)/],["Instagram",/Instagram\s([0-9.]+)/],["iOS WebView",/AppleWebKit\/([0-9.]+).*Mobile/],["iOS WebView",/AppleWebKit\/([0-9.]+).*Gecko\)$/]];function fe(e){return e!==""&&ue.reduce((t,[r,n])=>{if(t)return t;let o=n.exec(e);return!!o&&[r,o]},!1)}var me=[["iOS",void 0,/iP(hone|od|ad)/],["Android",void 0,/Android/],["BlackBerry",void 0,/BlackBerry|BB10/],["Windows Mobile",void 0,/IEMobile/],["Kindle",void 0,/Kindle/],["Windows","3.11",/Win16/],["Windows","95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows","98",/(Windows 98)|(Win98)/],["Windows","2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows","XP",/(Windows NT 5.1)|(Windows XP)/],["Windows","Server 2003",/(Windows NT 5.2)/],["Windows","Vista",/(Windows NT 6.0)/],["Windows","7",/(Windows NT 6.1)/],["Windows","8",/(Windows NT 6.2)/],["Windows","8.1",/(Windows NT 6.3)/],["Windows","10+",/(Windows NT 10.0)/],["Windows","ME",/Windows ME/],["Open BSD",void 0,/OpenBSD/],["Sun OS",void 0,/SunOS/],["Chrome OS",void 0,/CrOS/],["Linux",void 0,/(Linux)|(X11)/],["Mac OS",void 0,/(Mac_PowerPC)|(Macintosh)/],["QNX",void 0,/QNX/],["BeOS",void 0,/BeOS/],["OS/2",void 0,/OS\/2/]];function he(e){for(let[t,r,n]of me)if(n.exec(e))return{osName:t,osVersion:r};return null}function pe(e){let t=/iPad|iPhone|iPod/.exec(e);return t?{manufacturer:"Apple",model:t[0]}:/MacIntel/.test(e)&&self.navigator&&self.navigator.maxTouchPoints&&self.navigator.maxTouchPoints>2?{manufacturer:"Apple",model:"iPad"}:null}var ge=e=>({name:"browserContext",load(t){t.addOnError(r=>{r.request={...r.request,url:self.location.href},r.context=r.context||self.location.pathname,r.device={...r.device,...e(self.navigator.userAgent),locale:self.navigator.language,userAgent:self.navigator.userAgent};let n=["n/a"];try{n=self.navigator.languages}catch{}r.metaData={...r.metaData,language:{language:self.navigator.language,languages:n}}})}}),I=ge(le);var M=e=>{let t=0,r=()=>{t=0};return typeof window<"u"&&window.addEventListener("popstate",r),{name:"limitEvents",load(n){return n.addOnError(function(){if(t>=e)return!1;t++}),{reset:r}}}};var L={name:"browserHandledRejectionBreadcrumbs",load(e){self.addEventListener("rejectionhandled",t=>{let r=t.reason,{exceptions:n}=g(r,"handledrejection"),o=`Handled Promise rejection: [${n[0].errorClass}] ${n[0].message}`;e.leaveBreadcrumb(o,{stacktrace:n[0].stacktrace},"error")})}};var be=class{breadcrumbs=[];config;delivery=new V(this);errorCallbacks=new Set;postErrorCallbacks=new Set;plugins=[];start(e){if(this.config)return console.error("Bugsnag.start called multiple times. Subsequent invocations will be ignored"),this;this.config=e;let t;this.config.onError&&(t=typeof this.config.onError=="function"?[this.config.onError]:this.config.onError),this.errorCallbacks=new Set(t);for(let r of this.config.plugins||[])this.plugins.push({name:r.name||"unknown",plugin:r.load(this)});return this.leaveBreadcrumb("Bugsnag loaded",{},"state"),this}get endpoints(){return{notify:this.config?.endpoints?.notify||"https://notify.bugsnag.com/"}}notify(e,t={}){let{exceptions:r,metadata:n}=g(e,"notify"),o,a;return typeof t=="function"?o=t:(a=t.severity,t.metadata&&(n={...n,...t.metadata})),this.notifyEvent({exceptions:r,metadata:n,severity:a,onError:o},e)}leaveBreadcrumb(e,t,r){if(!this.config)return;if(typeof e!="string")try{e=String(e)}catch{e="Unable to stringify breadcrumb message"}if(!e.length)return;this.breadcrumbs.push({name:e,metaData:t,type:r||"manual",timestamp:new Date().toISOString()});let{maxBreadcrumbs:n=25}=this.config;this.breadcrumbs.length>n&&this.breadcrumbs.splice(0,this.breadcrumbs.length-n)}async notifyEvent({exceptions:e,unhandled:t,severity:r,severityReason:n,metadata:o,onError:a},i){if(!this.config)return;let c=this.config.releaseStage||"production";if(this.config.enabledReleaseStages&&!this.config.enabledReleaseStages.includes(c))return;let s={exceptions:e,breadcrumbs:this.breadcrumbs.length?this.breadcrumbs:void 0,originalError:i,unhandled:typeof t!="boolean"?!1:t,severity:r||"warning",severityReason:n,user:this.config.user||void 0,app:{releaseStage:c,version:this.config.appVersion,type:this.config.appType||(typeof window=="object"?"browser":"node")},device:{time:new Date().toISOString()},metaData:o||{}},l=[...this.errorCallbacks];a&&l.push(a);let d=["stringifyValues","redact"];l.sort((m,p)=>d.includes(m.name)&&d.includes(p.name)?0:d.includes(m.name)?1:d.includes(p.name)?-1:0);for(let m of l){let p=await m(s);if(typeof p=="boolean"&&!p)return}let u={name:"@birchill/bugsnag-zero",version:"1",url:"https://github.com/birchill/bugsnag-zero"},f=K(s,(m,p)=>{if(m!=="originalError")return p},{depthLimit:20,edgesLimit:500}),h,b={apiKey:this.config.apiKey,payloadVersion:"5",notifier:u,events:[f]};try{h=JSON.stringify(b)}catch{f.metaData={notifier:"Unable to serialize metadata"},h=JSON.stringify(b)}if(h.length>1e6&&(f.metaData={notifier:`Payload was ${h.length/1e6}Mb. Metadata removed.`},h=JSON.stringify(b),h.length>1e6))throw new Error("Payload exceeded 1Mb limit");for(let m of this.postErrorCallbacks)m(s);try{await this.delivery.sendEvent(b)}catch(m){console.error("Failed to post report to Bugsnag",m)}}getUser(){return this.config?.user||{}}setUser(e,t,r){this.config&&(this.config.user={id:e,email:t,name:r})}addOnError(e){this.errorCallbacks.add(e)}removeOnError(e){this.errorCallbacks.delete(e)}addOnPostError(e){this.postErrorCallbacks.add(e)}removeOnPostError(e){this.postErrorCallbacks.delete(e)}getPlugin(e){return this.plugins.find(t=>t.name===e)?.plugin}setDelivery(e){this.delivery=e}},ye=new be,U=ye;if(!navigator.webdriver&&"structuredClone"in window){let e=["AbortError","EvalError","InvalidError","ServerError"];U.start({apiKey:"185908d122d2ed3035950553bb07bd7a",appType:"browser",appVersion:document.body.dataset.rev,plugins:[T,I,L,k,j,$,A,P,R,M(10)],onError:t=>{if(!("SteamDB"in window)||document.getElementById("js-warn-outdated-browser"))return!1;let r=!1,n=location.origin+"/static/";for(let o of t.exceptions){if(e.includes(o.errorClass)||o.errorClass==="TypeError"&&o.message==="Failed to fetch")return!1;for(let a of o.stacktrace){if(/^(?:chrome|moz|safari)-extension:/.test(a.file))return!1;r||(r=a.file.startsWith(n))}}return r}})}})();
